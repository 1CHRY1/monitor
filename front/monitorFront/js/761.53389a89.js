"use strict";(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[761],{761:function(e,l,a){a.r(l),a.d(l,{default:function(){return R}});var t=a(3396),o=a(7139),r=a(9242);const d=e=>((0,t.dD)("data-v-140d5b14"),e=e(),(0,t.Cn)(),e),n={class:"upload-resource"},u={class:"main"},i=d((()=>(0,t._)("div",{class:"head"},[(0,t._)("strong",null,"创建新的共享文件条目")],-1))),s=d((()=>(0,t._)("div",{class:"des"},[(0,t.Uk)(" 请确保以下内容的"),(0,t._)("strong",null,"真实性"),(0,t.Uk)("及"),(0,t._)("strong",null,"完整性"),(0,t.Uk)("，以便管理员审核通过！审核工作预计在7个工作日内完成 ")],-1))),m={ref:"container",class:"container"},p={style:{border:"1px solid #ccc"}},f={class:"btn"};function c(e,l,a,d,c,g){const v=(0,t.up)("el-divider"),w=(0,t.up)("el-input"),b=(0,t.up)("el-form-item"),h=(0,t.up)("el-tag"),y=(0,t.up)("el-button"),V=(0,t.up)("avatar-upload"),_=(0,t.up)("el-form"),W=(0,t.up)("el-option"),C=(0,t.up)("el-option-group"),k=(0,t.up)("el-select"),U=(0,t.up)("data-bind"),I=(0,t.up)("Toolbar"),j=(0,t.up)("Editor"),H=(0,t.up)("page-copyright");return(0,t.wg)(),(0,t.iD)("div",n,[(0,t._)("div",u,[i,s,(0,t.Wm)(v),(0,t.Wm)(_,{"label-width":"130px",model:e.form,rules:e.fileRules,ref:"fileRef"},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{label:"条目名：",prop:"name"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:e.form.name,"onUpdate:modelValue":l[0]||(l[0]=l=>e.form.name=l)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"条目描述：",prop:"description"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:e.form.description,"onUpdate:modelValue":l[1]||(l[1]=l=>e.form.description=l),type:"textarea",resize:"none",rows:3},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"标签：",prop:"tags"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.form.tags,(l=>((0,t.wg)(),(0,t.j4)(h,{key:l,closable:"","disable-transitions":!1,onClose:a=>e.handleClose(l)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(l),1)])),_:2},1032,["onClose"])))),128)),e.inputVisible?((0,t.wg)(),(0,t.j4)(w,{key:0,ref:"InputRef",class:"tag-input",modelValue:e.inputValue,"onUpdate:modelValue":l[2]||(l[2]=l=>e.inputValue=l),onKeyup:(0,r.D2)(e.handleInputConfirm,["enter"]),onBlur:e.handleInputConfirm},null,8,["modelValue","onKeyup","onBlur"])):((0,t.wg)(),(0,t.j4)(y,{key:1,onClick:e.showInput},{default:(0,t.w5)((()=>[(0,t.Uk)(" + New Tag ")])),_:1},8,["onClick"]))])),_:1}),(0,t.Wm)(b,{label:"条目封面："},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{onReturnPicture:e.returnPicture,pictureName:"",ref:"avatarUpload"},null,8,["onReturnPicture"])])),_:1})])),_:1},8,["model","rules"]),(0,t.Wm)(v),(0,t.Wm)(_,{"label-width":"130px",model:e.form,ref:"metaRef",rules:e.metaRules},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{label:"数据提供方：",prop:"provider"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:e.form.provider,"onUpdate:modelValue":l[3]||(l[3]=l=>e.form.provider=l)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"联系电话："},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:e.form.providerPhone,"onUpdate:modelValue":l[4]||(l[4]=l=>e.form.providerPhone=l)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"联系邮箱："},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:e.form.providerEmail,"onUpdate:modelValue":l[5]||(l[5]=l=>e.form.providerEmail=l)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"联系地址："},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:e.form.providerAddress,"onUpdate:modelValue":l[6]||(l[6]=l=>e.form.providerAddress=l)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"原始数据类型：",prop:"type"},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{modelValue:e.form.type,"onUpdate:modelValue":l[7]||(l[7]=l=>e.form.type=l),placeholder:"数据类型",size:"large",style:{width:"300px"}},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.classList,((e,l)=>((0,t.wg)(),(0,t.j4)(C,{key:l,label:e.lable},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.value,((e,l)=>((0,t.wg)(),(0,t.j4)(W,{key:l,label:e,value:e},null,8,["label","value"])))),128))])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),"实时水位"===e.form.type?((0,t.wg)(),(0,t.j4)(b,{key:0,label:"绑定水位站："},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{modelValue:e.stationId,"onUpdate:modelValue":l[8]||(l[8]=l=>e.stationId=l),placeholder:"绑定水位站",size:"large",style:{width:"300px"}},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.stationList,((e,l)=>((0,t.wg)(),(0,t.j4)(W,{key:l,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):(0,t.kq)("",!0),(0,t.Wm)(b,{label:"数据时间："},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:e.form.timeStamp,"onUpdate:modelValue":l[9]||(l[9]=l=>e.form.timeStamp=l)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"空间范围描述："},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:e.form.range,"onUpdate:modelValue":l[10]||(l[10]=l=>e.form.range=l)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"空间范围选取："},{default:(0,t.w5)((()=>[(0,t._)("div",m,null,512)])),_:1}),"实时水位"!==e.form.type?((0,t.wg)(),(0,t.j4)(b,{key:1,label:"数据绑定："},{default:(0,t.w5)((()=>[(0,t.Wm)(U,{onChangeData:e.changeData,ref:"dataBind"},null,8,["onChangeData"])])),_:1})):(0,t.kq)("",!0),(0,t.Wm)(b,{label:"其他描述："},{default:(0,t.w5)((()=>[(0,t._)("div",p,[(0,t.Wm)(I,{style:{"border-bottom":"1px solid #ccc"},editor:e.editorRef,defaultConfig:e.toolbarConfig,mode:"default"},null,8,["editor","defaultConfig"]),(0,t.Wm)(j,{style:{height:"320px","overflow-y":"hidden"},modelValue:e.form.detail,"onUpdate:modelValue":l[11]||(l[11]=l=>e.form.detail=l),defaultConfig:e.editorConfig,mode:"default",onOnCreated:e.handleCreated},null,8,["modelValue","defaultConfig","onOnCreated"])])])),_:1})])),_:1},8,["model","rules"])]),(0,t._)("div",f,[(0,t.Wm)(y,{type:"success",plain:"",onClick:l[12]||(l[12]=l=>e.commit(e.fileRef,e.metaRef))},{default:(0,t.w5)((()=>[(0,t.Uk)("提交")])),_:1})]),(0,t.Wm)(H)])}a(7658);var g=a(4870),v=a(6126),w=a(26),b=a(6583),h=a(8296),y=a(9928),V=a(8938),_=a(7709),W=a.n(_),C=a(5884),k=a.n(C),U=a(8993),I=(0,t.aZ)({components:{Editor:v.M,Toolbar:v.o,AvatarUpload:h.Z,DataBind:y.Z,PageCopyright:V.Z},setup(){const e={children:"children",label:"label"},l=(0,g.iH)(),a=(0,g.iH)(),o=(0,g.iH)(""),r=(0,g.iH)(!1),d=(0,g.iH)(),n=(0,g.iH)(),u=(0,g.qj)({id:(0,b.Vj)(),name:"",location:[],description:"",tags:[],avatar:"",provider:"",range:"",detail:"",type:"",providerPhone:"",providerEmail:"",providerAddress:"",timeStamp:""}),i=(0,g.iH)(""),s=(0,g.iH)([]),m=(0,g.XI)(),p={},f={scroll:!0,autoFocus:!0},c=(0,g.iH)([]),v=(0,g.iH)(),h=(0,g.iH)();let y;const V=e=>{m.value=e},_=e=>{c.value=[],e.forEach((e=>{c.value.push(e.id)}))},C=async(e,l)=>{e&&l&&await e.validate((async(e,a)=>{await l.validate((async l=>{if(e&&l){const e=await(0,w.S1)(u),l=await(0,w.cD)({dataListId:u.id,fileIdList:"实时水位"!==u.type?c.value:[i.value]});null!=e&&0===e.code&&null!=l&&0===l.code&&(D(),(0,b.Iv)("success","成功","新条目创建成功"))}}))}))},I=e=>{u.tags.splice(u.tags.indexOf(e),1)},j=()=>{o.value&&u.tags.push(o.value),r.value=!1,o.value=""},H=()=>{r.value=!0,(0,t.Y3)((()=>{d.value.input.focus()}))},R=e=>{u.avatar=e},D=()=>{u.id=(0,b.Vj)(),u.name="",u.description="",u.location=[],u.tags=[],u.range="",u.detail="",u.provider="",u.type="",u.providerPhone="",u.providerEmail="",u.providerAddress="",u.timeStamp="",u.avatar="",n.value?.clearAvatar(),a.value?.clearData()},x=(0,g.qj)({name:[{required:!0,message:"条目名不得为空！",trigger:"blur"}],tags:[{required:!0,message:"标签不得为空！",trigger:"blur"}]}),E=(0,g.qj)({provider:[{required:!0,message:"数据提供方不得为空！",trigger:"blur"}],type:[{required:!0,message:"数据类型不得为空！",trigger:"blur"}],getOnline:[{required:!0,message:"数据获取方式不得为空！",trigger:"blur"}]}),q=()=>{y=new(W().Map)({container:l.value,style:"mapbox://styles/johnnyt/cl9miecpn001t14rspop38nyk",center:[121.18,31.723],zoom:8,accessToken:"pk.eyJ1Ijoiam9obm55dCIsImEiOiJja2xxNXplNjYwNnhzMm5uYTJtdHVlbTByIn0.f1GfZbFLWjiEayI6hb_Qvg"});const e=new(k())({controls:{combine_features:!1,uncombine_features:!1,trash:!0,point:!1,line_string:!1}}),a=function(l){"draw.create"===l.type?(e.getAll().features.length>1&&e.delete(e.getAll().features[0].id),u.location=[],l.features[0].geometry.coordinates[0].forEach((e=>{u.location.push(e[0].toString()),u.location.push(e[1].toString())}))):"draw.update"===l.type?(u.location=[],l.features[0].geometry.coordinates[0].forEach((e=>{u.location.push(e[0].toString()),u.location.push(e[1].toString())}))):"draw.delete"===l.type&&(u.location=[])};y.addControl(e,"top-right"),y.on("draw.create",a),y.on("draw.delete",a),y.on("draw.update",a)};(0,t.Jd)((()=>{const e=m.value;null!=e&&e.destroy()}));const P=async()=>{const e=await(0,w.fN)();e&&0===e.code&&(s.value=e.data)};return(0,t.bv)((()=>{P(),q()})),{avatarUpload:n,container:l,form:u,defaultProps:e,inputValue:o,inputVisible:r,InputRef:d,classList:U.s,editorRef:m,toolbarConfig:p,editorConfig:f,handleCreated:V,commit:C,fileRules:x,metaRules:E,fileRef:v,metaRef:h,changeData:_,dataBind:a,stationId:i,stationList:s,handleClose:I,handleInputConfirm:j,showInput:H,returnPicture:R}}}),j=a(89);const H=(0,j.Z)(I,[["render",c],["__scopeId","data-v-140d5b14"]]);var R=H}}]);
//# sourceMappingURL=761.53389a89.js.map