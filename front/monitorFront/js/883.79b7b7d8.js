"use strict";(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[883],{6678:function(e,a,l){l.r(a),l.d(a,{default:function(){return Hl}});var t=l(3396);const i={class:"main"},n={class:"body"},s={class:"left",ref:"left"},o={class:"left-resize",ref:"leftResize"};function u(e,a,l,u,d,r){const c=(0,t.up)("top-tool"),v=(0,t.up)("data-manage"),p=(0,t.up)("el-skeleton"),y=(0,t.up)("layer-manage"),m=(0,t.up)("right-visual");return(0,t.wg)(),(0,t.iD)("div",i,[(0,t.Wm)(c,{onReturnFileList:e.returnFileList,onOperateDraw:e.operateDraw,onAnalyse:e.analyse},null,8,["onReturnFileList","onOperateDraw","onAnalyse"]),(0,t._)("div",n,[(0,t._)("div",s,[(0,t.Wm)(v,{class:"top",ref:"dataManage",onOperateLayer:e.operateLayer},null,8,["onOperateLayer"]),e.skeletonFlag?((0,t.wg)(),(0,t.j4)(p,{key:0,rows:5,animated:"",class:"bottom"})):((0,t.wg)(),(0,t.j4)(y,{key:1,class:"bottom",ref:"layerManage",layerList:e.layerList,onCloseLayer:e.closeLayer,onHideLayer:e.hideLayer,onMoveLayer:e.moveLayer},null,8,["layerList","onCloseLayer","onHideLayer","onMoveLayer"])),(0,t._)("div",o,null,512)],512),e.skeletonFlag?((0,t.wg)(),(0,t.j4)(p,{key:0,rows:5,animated:""})):((0,t.wg)(),(0,t.j4)(m,{key:1,layerList:e.layerList,ref:"rightMap",onDrawHandle:e.drawHandle},null,8,["layerList","onDrawHandle"]))])])}var d=l(4870),r=l(26);const c=e=>((0,t.dD)("data-v-469097b0"),e=e(),(0,t.Cn)(),e),v={class:"top-tool"},p={class:"base-function"},y={style:{width:"16px",height:"16px","margin-right":"10px"}},m=c((()=>(0,t._)("use",{"xlink:href":"#icon-tianjiayingyong"},null,-1))),f=[m],g={style:{width:"16px",height:"16px","margin-right":"10px"}},h=c((()=>(0,t._)("use",{"xlink:href":"#icon-shujuyanjiu"},null,-1))),w=[h],k={class:"map-tool"},I={style:{width:"16px",height:"16px","margin-right":"10px"}},b=c((()=>(0,t._)("use",{"xlink:href":"#icon-xian"},null,-1))),T=[b],L={style:{width:"16px",height:"16px","margin-right":"10px"}},D=c((()=>(0,t._)("use",{"xlink:href":"#icon-mian"},null,-1))),_=[D],C={class:"right"};function x(e,a,l,i,n,s){const o=(0,t.up)("el-button"),u=(0,t.up)("el-divider"),d=(0,t.up)("add-data-dialog"),r=(0,t.up)("el-dialog"),c=(0,t.up)("analyse-dialog");return(0,t.wg)(),(0,t.iD)("div",v,[(0,t._)("div",p,[(0,t.Wm)(o,{type:"primary",text:"",onClick:a[0]||(a[0]=a=>e.dialogAddData=!0)},{default:(0,t.w5)((()=>[((0,t.wg)(),(0,t.iD)("svg",y,f)),(0,t.Uk)("添加")])),_:1}),(0,t.Wm)(u,{direction:"vertical"}),(0,t.Wm)(o,{type:"primary",text:"",onClick:a[1]||(a[1]=a=>e.dialogAnalyse=!0)},{default:(0,t.w5)((()=>[((0,t.wg)(),(0,t.iD)("svg",g,w)),(0,t.Uk)("河床分析")])),_:1})]),(0,t._)("div",k,[(0,t.Wm)(o,{type:"primary",text:1!==e.state,onClick:e.sectionClick},{default:(0,t.w5)((()=>[((0,t.wg)(),(0,t.iD)("svg",I,T)),(0,t.Uk)("绘制断面")])),_:1},8,["text","onClick"]),(0,t.Wm)(u,{direction:"vertical"}),(0,t.Wm)(o,{type:"primary",text:2!==e.state,onClick:e.regionClick},{default:(0,t.w5)((()=>[((0,t.wg)(),(0,t.iD)("svg",L,_)),(0,t.Uk)("绘制区域")])),_:1},8,["text","onClick"])]),(0,t._)("div",C,[(0,t.Wm)(o,{type:"info",onClick:e.flowClick},{default:(0,t.w5)((()=>[(0,t.Uk)("流场动画")])),_:1},8,["onClick"])]),(0,t.Wm)(r,{modelValue:e.dialogAddData,"onUpdate:modelValue":a[2]||(a[2]=a=>e.dialogAddData=a),width:"1000px",title:"添加数据"},{default:(0,t.w5)((()=>[e.dialogAddData?((0,t.wg)(),(0,t.j4)(d,{key:0,onReturnData:e.returnData},null,8,["onReturnData"])):(0,t.kq)("",!0)])),_:1},8,["modelValue"]),(0,t.Wm)(r,{modelValue:e.dialogAnalyse,"onUpdate:modelValue":a[3]||(a[3]=a=>e.dialogAnalyse=a),width:"700px",title:"河床分析"},{default:(0,t.w5)((()=>[e.dialogAnalyse?((0,t.wg)(),(0,t.j4)(c,{key:0,onAnalyse:e.analyse},null,8,["onAnalyse"])):(0,t.kq)("",!0)])),_:1},8,["modelValue"])])}l(7658);var V=l(7139),F=l(9242);const A={class:"add-data"},N={key:1,class:"add-data-dialog"},H={class:"tree"},P={key:0,class:"custom"},W={key:1,class:"custom"},S={class:"add-data-card"},Z={class:"head"},j={class:"right"},E={style:{color:"#409eff"}},z={class:"search"},R=["onClick"],U={class:"img"},M=["src"],q={class:"name"},J={key:1},O={class:"page"},K={class:"content"},Y={class:"table"},$={class:"btn"};function B(e,a,l,i,n,s){const o=(0,t.up)("el-skeleton"),u=(0,t.up)("el-tree"),d=(0,t.up)("el-input"),r=(0,t.up)("el-col"),c=(0,t.up)("el-row"),v=(0,t.up)("el-empty"),p=(0,t.up)("el-pagination"),y=(0,t.up)("el-page-header"),m=(0,t.up)("el-checkbox"),f=(0,t.up)("el-table-column"),g=(0,t.up)("el-table"),h=(0,t.up)("el-button"),w=(0,t.Q2)("loading");return(0,t.wy)(((0,t.wg)(),(0,t.iD)("div",A,[(0,t.wy)((0,t._)("div",null,[e.skeletonFlag?((0,t.wg)(),(0,t.j4)(o,{key:0,rows:5,animated:""})):((0,t.wg)(),(0,t.iD)("div",N,[(0,t._)("div",H,[(0,t.Wm)(u,{data:e.treeData,props:e.defaultProps,accordion:"","highlight-current":"","node-key":"label",ref:"tree",onNodeClick:e.nodeClick},{default:(0,t.w5)((({node:e,data:a})=>[void 0!=a.children?((0,t.wg)(),(0,t.iD)("strong",P,(0,V.zw)(e.label),1)):((0,t.wg)(),(0,t.iD)("span",W,(0,V.zw)(e.label),1))])),_:1},8,["data","props","onNodeClick"])]),(0,t._)("div",S,[(0,t._)("div",Z,[(0,t._)("div",null,[(0,t.Uk)(" 筛选类别："),(0,t._)("strong",null,(0,V.zw)(""===e.selectData?"默认所有":e.selectData),1)]),(0,t._)("div",j,[(0,t.Uk)(" 已选择 "),(0,t._)("strong",E,(0,V.zw)(e.fileList.length),1),(0,t.Uk)(" 条数据 ")])]),(0,t._)("div",z,[(0,t.Wm)(d,{modelValue:e.search,"onUpdate:modelValue":a[0]||(a[0]=a=>e.search=a),"suffix-icon":e.Search,placeholder:"条目名",onKeydown:(0,F.D2)(e.enterHandle,["enter"])},null,8,["modelValue","suffix-icon","onKeydown"])]),0!=e.dataList.length?((0,t.wg)(),(0,t.j4)(c,{key:0},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.dataList,((a,l)=>((0,t.wg)(),(0,t.j4)(r,{span:6,key:l},{default:(0,t.w5)((()=>[(0,t._)("div",{class:"card",onClick:a=>e.cardClick(l)},[(0,t._)("div",U,[(0,t._)("img",{src:e.getAvatar(a.avatar,a.name)},null,8,M)]),(0,t._)("div",q,[(0,t._)("strong",null,(0,V.zw)(a.name),1)])],8,R)])),_:2},1024)))),128))])),_:1})):((0,t.wg)(),(0,t.iD)("div",J,[(0,t.Wm)(v,{description:"暂无数据"})]))])])),(0,t._)("div",O,[(0,t.Wm)(p,{small:"",background:"",layout:"total, jumper, prev, pager, next","pager-count":5,total:e.total,"hide-on-single-page":!0,"current-page":e.currentPage,"onUpdate:currentPage":a[1]||(a[1]=a=>e.currentPage=a),onCurrentChange:e.pageChange},null,8,["total","current-page","onCurrentChange"])])],512),[[F.F8,e.dataListShow]]),(0,t.wy)((0,t._)("div",null,[(0,t.Wm)(y,{icon:e.ArrowLeft,onBack:a[2]||(a[2]=a=>e.dataListShow=!0)},{content:(0,t.w5)((()=>[(0,t._)("span",null,(0,V.zw)(e.selectDataList.name),1)])),_:1},8,["icon"]),(0,t._)("div",K,[(0,t._)("div",Y,[(0,t.Wm)(g,{data:e.tableData,stripe:""},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{width:"55"},{header:(0,t.w5)((()=>[(0,t.Uk)(" 选择 ")])),default:(0,t.w5)((a=>[(0,t.Wm)(m,{modelValue:a.row.flag,"onUpdate:modelValue":e=>a.row.flag=e,size:"large",onChange:l=>e.checkboxChange(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),(0,t.Wm)(f,{prop:"name",label:"文件名称",width:"300"}),(0,t.Wm)(f,{prop:"size",label:"文件大小",width:"100"}),(0,t.Wm)(f,{prop:"time",label:"时间",width:"150"}),(0,t.Wm)(f,{prop:"location",label:"位置"})])),_:1},8,["data"])])])],512),[[F.F8,!e.dataListShow]]),(0,t._)("div",$,[(0,t.Wm)(h,{type:"primary",plain:"",onClick:e.commit},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1},8,["onClick"])])])),[[w,e.loading]])}var X=l(2748),G=l(6583),Q=l(8993),ee=(0,t.aZ)({emits:["returnData"],setup(e,a){const l={children:"children",label:"label"},i=Q._,n=(0,d.iH)(),s=(0,d.iH)(""),o=(0,d.iH)(""),u=(0,d.iH)(0),c=(0,d.iH)(1),v=(0,d.iH)(!0),p=(0,d.iH)([]),y=(0,d.iH)({id:"",name:"",avatar:""}),m=(0,d.iH)([]),f=(0,d.iH)([]),g=(0,d.iH)(!0),h=(0,d.iH)(!1),w=(0,d.iH)(""),k=(e,a)=>""===e?(0,G.xW)(a):`/monitor/visual/getAvatar/${e}`,I=e=>{p.value=[],e.forEach((e=>{p.value.push({id:e.id,name:e.name,avatar:e.avatar})}))},b=e=>{m.value=[],e.forEach((e=>{if(""!=e.visualType){m.value.push({id:e.id,name:e.fileName,visualType:e.visualType,time:e.time,location:e.location,size:e.size,flag:!1,visualId:e.visualId});let a=!1;for(let l=0;l<f.value.length;l++)if(e.id===f.value[l].fileId){a=!0;break}m.value[m.value.length-1].flag=a}}))},T=async e=>{const a={page:e-1,size:8,titleKeyword:o.value,property:"update_time",flag:!1,type:w.value},l=await(0,r.Jm)(a);null!=l&&0===l.code&&(I(l.data.list),u.value=l.data.total,s.value=o.value)},L=async e=>{const a=await(0,r.g8)(p.value[e].id);null!=a&&0===a.code&&(b(a.data),y.value=p.value[e],v.value=!1)},D=e=>{if(e.flag)f.value.push({fileId:e.id,fileName:e.name,dataListId:y.value.id,dataListName:y.value.name,visualType:e.visualType,visualId:e.visualId});else for(let a=0;a<f.value.length;a++)if(e.id===f.value[a].fileId)return void f.value.splice(a,1)},_=()=>{a.emit("returnData",f.value)},C=async e=>{if(void 0===e.children){e.label!=w.value?w.value=e.label:(n.value.setCurrentKey(null),w.value="");const a={page:0,size:8,titleKeyword:o.value,property:"update_time",flag:!1,type:w.value};h.value=!0;const l=await(0,r.Jm)(a);null!=l&&0===l.code&&(I(l.data.list),u.value=l.data.total,c.value=1),h.value=!1}else if(n.value.setCurrentKey(null),""!=w.value){w.value="";const e={page:0,size:8,titleKeyword:o.value,property:"update_time",flag:!1,type:w.value};h.value=!0;const a=await(0,r.Jm)(e);null!=a&&0===a.code&&(I(a.data.list),u.value=a.data.total,c.value=1),h.value=!1}},x=async()=>{o.value=s.value;const e={page:0,size:8,titleKeyword:o.value,property:"update_time",flag:!1,type:w.value};h.value=!0;const a=await(0,r.Jm)(e);null!=a&&0===a.code&&(I(a.data.list),u.value=a.data.total,c.value=1),h.value=!1};return(0,t.bv)((async()=>{g.value=!0;const e={page:0,size:8,titleKeyword:o.value,property:"update_time",flag:!1,type:""},a=await(0,r.Jm)(e);null!=a&&0===a.code&&(I(a.data.list),u.value=a.data.total,g.value=!1)})),{defaultProps:l,treeData:i,search:s,dataList:p,Search:X.Search,total:u,getAvatar:k,currentPage:c,pageChange:T,dataListShow:v,ArrowLeft:X.ArrowLeft,selectDataList:y,cardClick:L,tableData:m,checkboxChange:D,commit:_,skeletonFlag:g,tree:n,nodeClick:C,fileList:f,selectData:w,enterHandle:x,loading:h}}}),ae=l(89);const le=(0,ae.Z)(ee,[["render",B],["__scopeId","data-v-b9cffe6a"]]);var te=le;const ie={class:"analyse-dialog"},ne=["onClick"],se={class:"picture"},oe=["src"],ue={class:"text"};function de(e,a,l,i,n,s){const o=(0,t.up)("el-tag"),u=(0,t.up)("el-col"),d=(0,t.up)("el-row"),r=(0,t.up)("analyse-interface");return(0,t.wg)(),(0,t.iD)("div",ie,[(0,t.wy)((0,t.Wm)(d,{gutter:10},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.list,((a,l)=>((0,t.wg)(),(0,t.j4)(u,{span:6,key:l},{default:(0,t.w5)((()=>[(0,t._)("div",{class:"card",onClick:l=>e.cardClick(a.value)},[(0,t._)("div",se,[(0,t._)("img",{src:a.src},null,8,oe)]),(0,t._)("div",ue,[(0,t.Wm)(o,{effect:"dark"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,V.zw)(a.name),1)])),_:2},1024)])],8,ne)])),_:2},1024)))),128))])),_:1},512),[[F.F8,e.flag]]),e.flag?(0,t.kq)("",!0):((0,t.wg)(),(0,t.j4)(r,{key:0,analyseType:e.analyseType,analyticDataList:e.analyticDataList,onBack:a[0]||(a[0]=a=>e.flag=!0),onReturnParameter:e.returnParameter},null,8,["analyseType","analyticDataList","onReturnParameter"]))])}const re=e=>((0,t.dD)("data-v-69d2fdd3"),e=e(),(0,t.Cn)(),e),ce={class:"analyse"},ve={class:"introduce"},pe={key:0},ye={key:1},me={key:2},fe={key:3},ge={key:4},he={key:5},we={key:6},ke={key:7},Ie={key:1,class:"deep"},be=re((()=>(0,t._)("span",null,[(0,t._)("strong",null,"水面距岸高度：")],-1))),Te={key:2},Le={key:0,class:"text"},De={key:1,class:"text"},_e={key:3,class:"dem"},Ce={class:"custom"},xe={key:0,class:"icon"},Ve={key:1,class:"text"},Fe={key:0},Ae={key:3,class:"section-flush"},Ne={class:"left"},He=re((()=>(0,t._)("div",{class:"text"},"选择基准面",-1))),Pe={key:1,class:"dem"},We={class:"custom"},Se={key:0,class:"icon"},Ze={key:1,class:"text"},je={key:0},Ee={class:"right"},ze=re((()=>(0,t._)("div",{class:"text"},"选择参考面",-1))),Re={key:1,class:"dem"},Ue={class:"custom"},Me={key:0,class:"icon"},qe={key:1,class:"text"},Je={key:0},Oe={class:"file-name"},Ke=re((()=>(0,t._)("div",null,"输出文件名:",-1))),Ye={class:"btn"};function $e(e,a,l,i,n,s){const o=(0,t.up)("el-page-header"),u=(0,t.up)("el-option"),d=(0,t.up)("el-select"),r=(0,t.up)("el-input-number"),c=(0,t.up)("el-skeleton"),v=(0,t.up)("FolderOpened"),p=(0,t.up)("el-icon"),y=(0,t.up)("el-checkbox"),m=(0,t.up)("el-tree"),f=(0,t.up)("el-scrollbar"),g=(0,t.up)("el-input"),h=(0,t.up)("el-button");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(o,{icon:e.ArrowLeft,onBack:e.backClick},{content:(0,t.w5)((()=>[(0,t._)("span",null,(0,V.zw)(e.title),1)])),_:1},8,["icon","onBack"]),(0,t._)("div",ce,[(0,t._)("div",ve,["section"===e.analyseType?((0,t.wg)(),(0,t.iD)("strong",pe,"断面形态是指随着断面起点距的变化河道高程的变化趋势，选择相应的河道DEM与断面数据，计算该断面形态")):(0,t.kq)("",!0),"sectionCompare"===e.analyseType?((0,t.wg)(),(0,t.iD)("strong",ye,"断面比较是指一条断面随着时间不同，河道地形发生的变化")):(0,t.kq)("",!0),"sectionFlush"===e.analyseType?((0,t.wg)(),(0,t.iD)("strong",me,"断面冲於是通过当前年数据和参考年数据，对这个时间段内河道的冲刷和淤泥进行比较分析")):(0,t.kq)("",!0),"regionFlush"===e.analyseType?((0,t.wg)(),(0,t.iD)("strong",fe,"区域冲於是通过当前年数据和参考年数据，对这个时间段内河床区域的冲刷和淤泥进行比较分析")):(0,t.kq)("",!0),"elevationFlush"===e.analyseType?((0,t.wg)(),(0,t.iD)("strong",ge,"针对整个长江南京以下河段，选择参数生成特定高程冲淤")):(0,t.kq)("",!0),"flushContour"===e.analyseType?((0,t.wg)(),(0,t.iD)("strong",he,"针对整个长江南京以下河段，选择参数生成冲淤等深线")):(0,t.kq)("",!0),"slope"===e.analyseType?((0,t.wg)(),(0,t.iD)("strong",we,"选择河床参数，计算河床坡度")):(0,t.kq)("",!0),"volume"===e.analyseType?((0,t.wg)(),(0,t.iD)("strong",ke,"选择河床参数与区域，设置最大深度计算河道容积")):(0,t.kq)("",!0)]),e.selectFlag?((0,t.wg)(),(0,t.j4)(d,{key:0,modelValue:e.sectionValue,"onUpdate:modelValue":a[0]||(a[0]=a=>e.sectionValue=a),placeholder:e.placeholder},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.options,((e,a)=>((0,t.wg)(),(0,t.j4)(u,{key:a,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])):(0,t.kq)("",!0),"volume"===e.analyseType?((0,t.wg)(),(0,t.iD)("div",Ie,[be,(0,t.Wm)(r,{modelValue:e.deep,"onUpdate:modelValue":a[1]||(a[1]=a=>e.deep=a),min:1,max:30,"controls-position":"right",precision:1,step:.1},null,8,["modelValue"])])):(0,t.kq)("",!0),"section"===e.analyseType||"sectionCompare"===e.analyseType||"slope"===e.analyseType||"volume"===e.analyseType?((0,t.wg)(),(0,t.iD)("div",Te,["section"===e.analyseType||"slope"===e.analyseType||"volume"===e.analyseType?((0,t.wg)(),(0,t.iD)("div",Le," 选择DEM数据，DEM将默认添加至数据与图层中 ")):(0,t.kq)("",!0),"sectionCompare"===e.analyseType?((0,t.wg)(),(0,t.iD)("div",De," 选择DEM数据，DEM将默认添加至数据与图层中，至少选择两个DEM数据 ")):(0,t.kq)("",!0),e.skeletonFlag?((0,t.wg)(),(0,t.j4)(c,{key:2,rows:5,animated:""})):((0,t.wg)(),(0,t.iD)("div",_e,[(0,t.Wm)(f,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,{data:e.treeData,props:e.defaultProps,"default-expand-all":""},{default:(0,t.w5)((({data:a})=>[(0,t._)("div",Ce,[a.flag?((0,t.wg)(),(0,t.iD)("div",xe,[(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)(v)])),_:1})])):(0,t.kq)("",!0),a.flag?((0,t.wg)(),(0,t.iD)("div",Ve,[a.flag?((0,t.wg)(),(0,t.iD)("strong",Fe,(0,V.zw)(a.label),1)):(0,t.kq)("",!0)])):((0,t.wg)(),(0,t.j4)(y,{key:2,modelValue:a.checkFlag,"onUpdate:modelValue":e=>a.checkFlag=e,size:"large",onChange:l=>e.changeClick(a)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,V.zw)(a.label),1)])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]))])])),_:1},8,["data","props"])])),_:1})]))])):(0,t.kq)("",!0),"sectionFlush"===e.analyseType||"regionFlush"===e.analyseType||"elevationFlush"===e.analyseType||"flushContour"===e.analyseType?((0,t.wg)(),(0,t.iD)("div",Ae,[(0,t._)("div",Ne,[He,e.skeletonFlag?((0,t.wg)(),(0,t.j4)(c,{key:0,rows:5,animated:""})):((0,t.wg)(),(0,t.iD)("div",Pe,[(0,t.Wm)(f,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,{data:e.benchmarkTreeData,props:e.defaultProps,"default-expand-all":""},{default:(0,t.w5)((({data:a})=>[(0,t._)("div",We,[a.flag?((0,t.wg)(),(0,t.iD)("div",Se,[(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)(v)])),_:1})])):(0,t.kq)("",!0),a.flag?((0,t.wg)(),(0,t.iD)("div",Ze,[a.flag?((0,t.wg)(),(0,t.iD)("strong",je,(0,V.zw)(a.label),1)):(0,t.kq)("",!0)])):((0,t.wg)(),(0,t.j4)(y,{key:2,modelValue:a.checkFlag,"onUpdate:modelValue":e=>a.checkFlag=e,size:"large",onChange:l=>e.changeClick(a,"benchmark")},{default:(0,t.w5)((()=>[(0,t.Uk)((0,V.zw)(a.label),1)])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]))])])),_:1},8,["data","props"])])),_:1})]))]),(0,t._)("div",Ee,[ze,e.skeletonFlag?((0,t.wg)(),(0,t.j4)(c,{key:0,rows:5,animated:""})):((0,t.wg)(),(0,t.iD)("div",Re,[(0,t.Wm)(f,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,{data:e.referTreeData,props:e.defaultProps,"default-expand-all":""},{default:(0,t.w5)((({data:a})=>[(0,t._)("div",Ue,[a.flag?((0,t.wg)(),(0,t.iD)("div",Me,[(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)(v)])),_:1})])):(0,t.kq)("",!0),a.flag?((0,t.wg)(),(0,t.iD)("div",qe,[a.flag?((0,t.wg)(),(0,t.iD)("strong",Je,(0,V.zw)(a.label),1)):(0,t.kq)("",!0)])):((0,t.wg)(),(0,t.j4)(y,{key:2,modelValue:a.checkFlag,"onUpdate:modelValue":e=>a.checkFlag=e,size:"large",onChange:l=>e.changeClick(a,"refer")},{default:(0,t.w5)((()=>[(0,t.Uk)((0,V.zw)(a.label),1)])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]))])])),_:1},8,["data","props"])])),_:1})]))])])):(0,t.kq)("",!0),(0,t._)("div",Oe,[Ke,(0,t.Wm)(g,{modelValue:e.inputValue,"onUpdate:modelValue":a[2]||(a[2]=a=>e.inputValue=a)},null,8,["modelValue"])]),(0,t._)("div",Ye,[(0,t.Wm)(h,{type:"primary",plain:"",onClick:e.btnClick},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1},8,["onClick"])])])])}var Be=(0,t.aZ)({props:{analyseType:{type:String},analyticDataList:{type:Object}},emits:["back","returnParameter"],setup(e,a){const l={children:"children",label:"label"},i=(0,t.Fl)((()=>"section"===e.analyseType?"断面形态":"sectionCompare"===e.analyseType?"断面比较":"sectionFlush"===e.analyseType?"断面冲淤":"regionFlush"===e.analyseType?"区域冲淤":"elevationFlush"===e.analyseType?"特定高程冲淤":"flushContour"===e.analyseType?"冲淤等深线":"slope"===e.analyseType?"河床坡度提取":"volume"===e.analyseType?"河道容积计算":void 0)),n=(0,t.Fl)((()=>"section"===e.analyseType||"sectionCompare"===e.analyseType||"sectionFlush"===e.analyseType?"选择断面":"选择区域")),s=(0,t.Fl)((()=>"elevationFlush"!==e.analyseType&&"flushContour"!==e.analyseType&&"slope"!==e.analyseType)),o=(0,t.Fl)((()=>e.analyticDataList)),u=(0,d.iH)([]),c=(0,d.iH)([]),v=(0,d.iH)([]),p=(0,d.iH)(!0),y=(0,d.iH)(""),m=(0,d.iH)([]),f=(0,d.iH)(),g=(0,d.iH)([]),h=(0,d.iH)(),w=(0,d.iH)(),k=(0,d.iH)(5),I=(0,d.iH)(""),b=()=>{a.emit("back")},T=(a,l)=>{if("section"===e.analyseType||"slope"===e.analyseType||"volume"===e.analyseType)u.value.forEach((e=>{e.children.forEach((l=>{l.id!=a.id?l.checkFlag=!1:l.checkFlag?f.value={fileId:l.id,fileName:l.label,dataListId:e.id,dataListName:e.label,visualId:l.visualId,visualType:l.visualType}:f.value=void 0}))}));else if("sectionCompare"===e.analyseType){if(a.checkFlag)g.value.push({fileId:a.id,fileName:a.label,dataListId:a.parentId,dataListName:a.parentName,visualId:a.visualId,visualType:a.visualType});else for(let e=0;e<g.value.length;e++)if(g.value[e].fileId===a.id)return void g.value.splice(e,1)}else"sectionFlush"!==e.analyseType&&"regionFlush"!==e.analyseType&&"elevationFlush"!==e.analyseType&&"flushContour"!==e.analyseType||("benchmark"===l?c.value.forEach((e=>{e.children.forEach((l=>{l.id!=a.id?l.checkFlag=!1:l.checkFlag?h.value={fileId:l.id,fileName:l.label,dataListId:e.id,dataListName:e.label,visualId:l.visualId,visualType:l.visualType}:h.value=void 0}))})):"refer"===l&&v.value.forEach((e=>{e.children.forEach((l=>{l.id!=a.id?l.checkFlag=!1:l.checkFlag?w.value={fileId:l.id,fileName:l.label,dataListId:e.id,dataListName:e.label,visualId:l.visualId,visualType:l.visualType}:w.value=void 0}))})))},L=()=>{if("section"===e.analyseType)if(""!=y.value&&void 0!=f.value&&""!=I.value)a.emit("returnParameter",{section:y.value,dem:f.value,fileName:I.value});else{let e="";e=""===y.value?"断面":void 0===f.value?"DEM":"输出文件名",(0,G.Iv)("warning","警告",e+"不得为空")}else if("volume"===e.analyseType)if(""!=y.value&&void 0!=f.value&&""!=I.value)a.emit("returnParameter",{region:y.value,dem:f.value,deep:k.value,fileName:I.value});else{let e="";e=""==y.value?"区域不得为空":void 0==f.value?"DEM不得为空":"输入文件名不得为空",(0,G.Iv)("warning","警告",e)}else if("sectionCompare"===e.analyseType)if(""!=y.value&&g.value.length>=2&&""!=I.value)a.emit("returnParameter",{section:y.value,demList:g.value,fileName:I.value});else{let e="";e=""===y.value?"断面不得为空":""===I.value?"输出文件名不得为空":"至少选择两个DEM数据",(0,G.Iv)("warning","警告",e)}else if("sectionFlush"===e.analyseType||"regionFlush"===e.analyseType)""!=y.value&&void 0!=h.value&&void 0!=w.value&&""!=I.value?w.value.fileId===h.value.fileId?(0,G.Iv)("warning","警告","基准DEM数据不能与参考DEM数据相同"):a.emit("returnParameter",{section:y.value,benchmarkDem:h.value,referDem:w.value,fileName:I.value}):""===y.value?"sectionFlush"===e.analyseType?(0,G.Iv)("warning","警告","请选择断面"):"regionFlush"===e.analyseType&&(0,G.Iv)("warning","警告","请选择区域"):""==I.value?(0,G.Iv)("warning","警告","输出文件名不得为空"):void 0===h.value?(0,G.Iv)("warning","警告","基准DEM数据不得为空"):(0,G.Iv)("warning","警告","参考DEM数据不得为空");else if("elevationFlush"===e.analyseType||"flushContour"===e.analyseType)if(void 0!=h.value&&void 0!=w.value&&""!=I.value)w.value.fileId===h.value.fileId?(0,G.Iv)("warning","警告","基准DEM数据不能与参考DEM数据相同"):a.emit("returnParameter",{benchmarkDem:h.value,referDem:w.value,fileName:I.value});else{let e="";e=void 0===h.value?"基准DEM数据不得为空":void 0===w.value?"参考DEM数据不得为空":"输出文件名不得为空",(0,G.Iv)("warning","警告",e)}else"slope"===e.analyseType&&(void 0!=f.value&&""!=I.value?a.emit("returnParameter",{dem:f.value,fileName:I.value}):(0,G.Iv)("warning","警告",""==I.value?"输出文件名不得为空":"请选择dem数据"))},D=async e=>{const a=await(0,r.No)("dem");if(null!=a&&0===a.code){for(let e=0;e<a.data.length;e++){let l=!0;for(let t=0;t<u.value.length;t++)if(u.value[t].id===a.data[e].dataListId){u.value[t].children.push({id:a.data[e].fileId,label:a.data[e].fileName,flag:!1,children:[],checkFlag:!1,visualId:a.data[e].visualId,visualType:a.data[e].visualType,parentId:a.data[e].dataListId,parentName:a.data[e].dataListName}),l=!1;break}l&&(u.value.push({id:a.data[e].dataListId,label:a.data[e].dataListName,flag:!0,children:[]}),u.value[u.value.length-1].children.push({id:a.data[e].fileId,label:a.data[e].fileName,flag:!1,checkFlag:!1,children:[],visualId:a.data[e].visualId,visualType:a.data[e].visualType,parentId:a.data[e].dataListId,parentName:a.data[e].dataListName}))}"sectionFlush"!==e&&"regionFlush"!==e&&"elevationFlush"!==e&&"flushContour"!==e||(c.value=JSON.parse(JSON.stringify(u.value)),v.value=JSON.parse(JSON.stringify(u.value))),"section"===e||"sectionCompare"===e||"sectionFlush"===e?(m.value=[],o.value.forEach((e=>{"geoJsonLine"===e.visualType&&m.value.push({id:e.id,name:e.fileName})}))):(m.value=[],o.value.forEach((e=>{"geoJsonPolygon"===e.visualType&&m.value.push({id:e.id,name:e.fileName})})))}};return(0,t.bv)((async()=>{p.value=!0,await D(e.analyseType),p.value=!1})),{ArrowLeft:X.ArrowLeft,title:i,analyticDataList:o,backClick:b,sectionValue:y,options:m,treeData:u,benchmarkTreeData:c,referTreeData:v,defaultProps:l,changeClick:T,btnClick:L,skeletonFlag:p,placeholder:n,selectFlag:s,deep:k,inputValue:I}}});const Xe=(0,ae.Z)(Be,[["render",$e],["__scopeId","data-v-69d2fdd3"]]);var Ge=Xe,Qe=l(3824),ea=(0,t.aZ)({components:{AnalyseInterface:Ge},emits:["analyse"],setup(e,a){const l=(0,d.iH)(!0),i=(0,d.iH)(""),n=(0,d.iH)(),s=[{name:"断面形态",src:"/analyse/断面形态.png",value:"section"},{name:"断面比较",src:"/analyse/断面比较.png",value:"sectionCompare"},{name:"断面冲淤",src:"/analyse/断面冲淤.png",value:"sectionFlush"},{name:"区域冲淤",src:"/analyse/区域冲淤.png",value:"regionFlush"},{name:"特定高程冲淤",src:"/analyse/特定高程冲淤.png",value:"elevationFlush"},{name:"冲淤等深线",src:"/analyse/冲淤等深线.png",value:"flushContour"},{name:"河道容积计算",src:"/analyse/河道容积.png",value:"volume"},{name:"河床坡度提取",src:"/analyse/河床坡度提取.png",value:"slope"}],o=e=>{l.value=!1,i.value=e},u=e=>{a.emit("analyse",{type:i.value,value:e})};return(0,t.bv)((async()=>{const e=await(0,r.J4)(Qe.ZP.currentRoute.value.params.id);null!=e&&0===e.code&&(n.value=e.data)})),{flag:l,list:s,cardClick:o,analyseType:i,analyticDataList:n,returnParameter:u}}});const aa=(0,ae.Z)(ea,[["render",de],["__scopeId","data-v-542da9f0"]]);var la=aa,ta=(0,t.aZ)({components:{AddDataDialog:te,AnalyseDialog:la},emits:["returnFileList","operateDraw","analyse"],setup(e,a){const l=(0,d.iH)(!1),t=(0,d.iH)(!1),i=(0,d.iH)(0),n=e=>{l.value=!1,a.emit("returnFileList",e)},s=()=>{1===i.value?i.value=0:i.value=1,a.emit("operateDraw",i.value)},o=()=>{2===i.value?i.value=0:i.value=2,a.emit("operateDraw",i.value)},u=e=>{a.emit("analyse",e),t.value=!1},r=()=>{Qe.ZP.push({path:"/flow"})};return{state:i,dialogAddData:l,returnData:n,sectionClick:s,regionClick:o,dialogAnalyse:t,analyse:u,flowClick:r}}});const ia=(0,ae.Z)(ta,[["render",x],["__scopeId","data-v-469097b0"]]);var na=ia;const sa=e=>((0,t.dD)("data-v-4efe9c6a"),e=e(),(0,t.Cn)(),e),oa={class:"data-manage"},ua={class:"data-manage-body"},da=sa((()=>(0,t._)("div",{class:"input"},null,-1))),ra={class:"content"},ca={key:1,class:"scroll"},va={class:"custom"},pa={class:"icon"},ya={class:"text"},ma={key:1},fa=sa((()=>(0,t._)("div",{class:"bottom"},[(0,t._)("strong",{style:{"margin-left":"30px"}},"数据管理")],-1))),ga={class:"right-menu",ref:"menu"},ha=sa((()=>(0,t._)("span",null,"添加至图层",-1))),wa=[ha],ka=sa((()=>(0,t._)("span",null,"可视化",-1))),Ia=[ka],ba=sa((()=>(0,t._)("span",null,"重命名",-1))),Ta=[ba],La=sa((()=>(0,t._)("span",null,"下载",-1))),Da=[La],_a=sa((()=>(0,t._)("span",null,"删除",-1))),Ca=[_a],xa={class:"btn"};function Va(e,a,l,i,n,s){const o=(0,t.up)("el-skeleton"),u=(0,t.up)("FolderOpened"),d=(0,t.up)("el-icon"),r=(0,t.up)("Document"),c=(0,t.up)("el-tree"),v=(0,t.up)("el-scrollbar"),p=(0,t.up)("el-input"),y=(0,t.up)("el-button"),m=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.iD)("div",oa,[(0,t._)("div",ua,[da,(0,t._)("div",ra,[e.skeletonFlag?((0,t.wg)(),(0,t.j4)(o,{key:0,rows:5,animated:""})):((0,t.wg)(),(0,t.iD)("div",ca,[(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Wm)(c,{data:e.treeData,props:e.defaultProps,onNodeContextmenu:e.rightClick,"default-expand-all":""},{default:(0,t.w5)((({data:e})=>[(0,t._)("div",va,[(0,t._)("div",pa,[e.flag?((0,t.wg)(),(0,t.j4)(d,{key:0,color:"分析结果集"==e.label?"#43c9b0":""},{default:(0,t.w5)((()=>[(0,t.Wm)(u)])),_:2},1032,["color"])):((0,t.wg)(),(0,t.j4)(d,{key:1},{default:(0,t.w5)((()=>[(0,t.Wm)(r)])),_:1}))]),(0,t._)("div",ya,[e.flag?((0,t.wg)(),(0,t.iD)("strong",{key:0,style:(0,V.j5)("分析结果集"==e.label?"color:#43c9b0":"")},(0,V.zw)(e.label),5)):((0,t.wg)(),(0,t.iD)("span",ma,(0,V.zw)(e.label),1))])])])),_:1},8,["data","props","onNodeContextmenu"])])),_:1})]))]),fa]),(0,t.wy)((0,t._)("div",null,[(0,t._)("ul",ga,[(0,t._)("li",{class:(0,V.C_)(e.isLayerVisual?"menu-item":"menu-item disabled"),onClick:a[0]||(a[0]=a=>e.operateLayer("add",e.isLayerVisual))},wa,2),(0,t._)("li",{class:(0,V.C_)(e.isLayerVisual?"menu-item disabled":"menu-item"),onClick:a[1]||(a[1]=a=>e.operateLayer("chart",!e.isLayerVisual))},Ia,2),(0,t._)("li",{class:"menu-item",onClick:a[2]||(a[2]=a=>e.operateLayer("rename",!0))},Ta),(0,t._)("li",{class:(0,V.C_)(e.downloadAble?"menu-item":"menu-item disabled"),onClick:a[3]||(a[3]=a=>e.operateLayer("download",e.downloadAble))},Da,2),(0,t._)("li",{class:"menu-item",onClick:a[4]||(a[4]=a=>e.operateLayer("del",!0))},Ca)],512)],512),[[F.F8,e.showRightMenu]]),(0,t.Wm)(m,{modelValue:e.dialogRename,"onUpdate:modelValue":a[6]||(a[6]=a=>e.dialogRename=a),width:"350px","show-close":!1},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:e.input,"onUpdate:modelValue":a[5]||(a[5]=a=>e.input=a)},null,8,["modelValue"]),(0,t._)("div",xa,[(0,t.Wm)(y,{type:"primary",plain:"",size:"small",onClick:e.btnClick},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1},8,["onClick"])])])),_:1},8,["modelValue"])])}var Fa=(0,t.aZ)({emits:["operateLayer"],setup(e,a){let l;const i={children:"children",label:"label"},n=(0,d.iH)([]),s=(0,d.iH)(!1),o=(0,d.iH)(!0),u=(0,d.iH)(),c=(0,d.iH)(),v=(0,d.iH)(""),p=(0,d.iH)(!1),y=(0,d.iH)(""),m=async e=>{const a={caseId:Qe.ZP.currentRoute.value.params.id,list:[]};e.forEach((e=>{let l=!0;for(let t=0;t<n.value.length;t++)if(n.value[t].id===e.dataListId){let i=!0;for(let a=0;a<n.value[t].children.length;a++)if(n.value[t].children[a].id===e.fileId){i=!1;break}i&&(n.value[t].children.push({id:e.fileId,label:e.fileName,flag:!1,children:[],visualType:e.visualType,visualId:e.visualId}),a.list.push({fileId:e.fileId,dataListId:e.dataListId})),l=!1;break}l&&(n.value.length>0&&""===n.value[n.value.length-1].id?(n.value.splice(n.value.length-1,0,{id:e.dataListId,label:e.dataListName,flag:!0,children:[]}),n.value[n.value.length-2].children.push({id:e.fileId,label:e.fileName,flag:!1,children:[],visualType:e.visualType,visualId:e.visualId})):(n.value.push({id:e.dataListId,label:e.dataListName,flag:!0,children:[]}),n.value[n.value.length-1].children.push({id:e.fileId,label:e.fileName,flag:!1,children:[],visualType:e.visualType,visualId:e.visualId})),a.list.push({fileId:e.fileId,dataListId:e.dataListId}))})),a.list.length>0&&await(0,r.L9)(a)},f=async e=>{const a={caseId:Qe.ZP.currentRoute.value.params.id,geoJson:e.geoJson,fileName:e.fileName,visualType:e.visualType},l=await(0,r.vG)(a);if(null!=l&&0===l.code)return 0!=n.value.length&&""===n.value[n.value.length-1].id||n.value.push({id:"",label:"分析结果集",flag:!0,children:[]}),n.value[n.value.length-1].children.push({id:l.data,label:e.fileName,flag:!1,children:[],visualType:e.visualType,visualId:""}),{id:l.data,name:e.fileName,visualType:e.visualType,visualId:""}},g=async e=>{if("section"===e.type){m([e.value.dem]),a.emit("operateLayer",{content:{id:e.value.dem.fileId,name:e.value.dem.fileName,visualType:e.value.dem.visualType,visualId:e.value.dem.visualId},type:"add"});const l=await(0,r.qG)({caseId:Qe.ZP.currentRoute.value.params.id,sectionId:e.value.section,demId:e.value.dem.fileId,fileName:e.value.fileName});null!==l&&0===l.code&&await w(l.data,"断面形态")}else if("sectionCompare"===e.type){m(e.value.demList);const l=[];e.value.demList.forEach((e=>{l.push(e.fileId),a.emit("operateLayer",{content:{id:e.fileId,name:e.fileName,visualType:e.visualType,visualId:e.visualId},type:"add"})}));const t=await(0,r.gm)({caseId:Qe.ZP.currentRoute.value.params.id,sectionId:e.value.section,fileName:e.value.fileName,demList:l});null!=t&&0===t.code&&await w(t.data,"断面比较")}else if("sectionFlush"===e.type||"regionFlush"===e.type||"elevationFlush"===e.type||"flushContour"===e.type)if(m([e.value.benchmarkDem]),a.emit("operateLayer",{content:{id:e.value.benchmarkDem.fileId,name:e.value.benchmarkDem.fileName,visualType:e.value.benchmarkDem.visualType,visualId:e.value.benchmarkDem.visualId},type:"add"}),m([e.value.referDem]),a.emit("operateLayer",{content:{id:e.value.referDem.fileId,name:e.value.referDem.fileName,visualType:e.value.referDem.visualType,visualId:e.value.referDem.visualId},type:"add"}),"sectionFlush"===e.type){const a=await(0,r.JR)({caseId:Qe.ZP.currentRoute.value.params.id,sectionId:e.value.section,benchmarkId:e.value.benchmarkDem.fileId,referId:e.value.referDem.fileId,fileName:e.value.fileName});null!=a&&0===a.code&&await w(a.data,"断面冲淤")}else if("regionFlush"===e.type){const a=await(0,r.o4)({caseId:Qe.ZP.currentRoute.value.params.id,regionId:e.value.section,benchmarkId:e.value.benchmarkDem.fileId,referId:e.value.referDem.fileId,fileName:e.value.fileName});null!=a&&0===a.code&&await w(a.data,"区域冲淤")}else if("elevationFlush"===e.type){const a=await(0,r.nX)({caseId:Qe.ZP.currentRoute.value.params.id,benchmarkId:e.value.benchmarkDem.fileId,referId:e.value.referDem.fileId,fileName:e.value.fileName});null!=a&&0===a.code&&(console.log(a),n.value[n.value.length-1].children.push({id:a.data.id,label:a.data.fileName,flag:!1,children:[],visualId:a.data.visualId,visualType:"elevationFlush"}),(0,G.Iv)("success","成功","特定高程冲淤计算成功！"))}else{const a=await(0,r.jn)({caseId:Qe.ZP.currentRoute.value.params.id,benchmarkId:e.value.benchmarkDem.fileId,referId:e.value.referDem.fileId,fileName:e.value.fileName});null!=a&&0===a.code&&(console.log(a),n.value[n.value.length-1].children.push({id:a.data.id,label:a.data.fileName,flag:!1,children:[],visualId:a.data.visualId,visualType:"flushContour"}),(0,G.Iv)("success","成功","冲淤等深线计算成功！"))}else if("slope"===e.type){console.log(e.value);const a=await(0,r.jh)({caseId:Qe.ZP.currentRoute.value.params.id,demId:e.value.dem.fileId,fileName:e.value.fileName});null!=a&&0===a.code&&(console.log(a),n.value[n.value.length-1].children.push({id:a.data.id,label:a.data.fileName,flag:!1,children:[],visualId:a.data.visualId,visualType:"slope"}),(0,G.Iv)("success","成功","河床坡度计算成功！"))}else if("volume"===e.type){m([e.value.dem]),a.emit("operateLayer",{content:{id:e.value.dem.fileId,name:e.value.dem.fileName,visualType:e.value.dem.visualType,visualId:e.value.dem.visualId},type:"add"});const l=await(0,r.$u)({caseId:Qe.ZP.currentRoute.value.params.id,regionId:e.value.region,demId:e.value.dem.fileId,deep:e.value.deep,fileName:e.value.fileName});null!=l&&0===l.code&&await w(l.data,"容积计算")}},h=async(e,l)=>{if(l)if("rename"!=e&&"download"!=e&&a.emit("operateLayer",{content:{id:c.value?.id,name:c.value?.label,visualType:c.value?.visualType,visualId:c.value?.visualId},type:e}),"del"===e){let e;if(e=""===v.value?await(0,r.HP)(c.value?.id):await(0,r.Is)(Qe.ZP.currentRoute.value.params.id,v.value,c.value?.id),null!=e&&0===e.code)for(let a=0;a<n.value.length;a++)if(n.value[a].id===v.value){if(0===n.value[a].children.length||1===n.value[a].children.length)return n.value.splice(a,1),void(0,G.Iv)("success","成功","数据删除成功!");for(let e=0;e<n.value[a].children.length;e++)if(n.value[a].children[e].id===c.value?.id)return n.value[a].children.splice(e,1),void(0,G.Iv)("success","成功","数据删除成功!")}}else"rename"===e?(p.value=!0,y.value=c.value?.label):"download"===e&&(window.location.href=`/monitor/analysis/downloadAnalysisResult/${c.value?.id}`)},w=async(e,a)=>{const t=await(0,r.XB)(e);null!==t&&0===t.code?(""!==n.value[n.value.length-1].id&&n.value.push({id:"",label:"分析结果集",children:[],flag:!0}),n.value[n.value.length-1].children.push({id:t.data.id,label:t.data.fileName,flag:!1,children:[],visualType:t.data.visualType,visualId:t.data.visualId}),(0,G.Iv)("success","成功",a+"计算成功！")):null!==t&&-1===t.code?l=setTimeout((async()=>{await w(e,a)}),2e3):(0,G.Iv)("error","错误",a+"计算失败！")},k=(e,a,l,t)=>{function i(){s.value=!1,document.removeEventListener("click",i)}!a.flag&&u.value&&(s.value=!1,s.value=!0,c.value=a,v.value=l.parent.data.id,u.value.style.left=e.clientX-15+"px",u.value.style.top=e.clientY-125+"px",document.addEventListener("click",i))},I=(0,t.Fl)((()=>"polygonVectorTile3D"===c.value?.visualType||"pointVectorTile3D"===c.value?.visualType||"pointVectorTile"===c.value?.visualType||"lineVectorTile3D"===c.value?.visualType||"polygonVectorTile"===c.value?.visualType||"lineVectorTile"===c.value?.visualType||"png"===c.value?.visualType||"movePng"===c.value?.visualType||"rasterTile"===c.value?.visualType||"geoJsonLine"===c.value?.visualType||"geoJsonPolygon"===c.value?.visualType||"regionFlush"===c.value?.visualType||"elevationFlush"===c.value?.visualType||"flushContour"===c.value?.visualType||"slope"===c.value?.visualType||"volume"===c.value?.visualType)),b=(0,t.Fl)((()=>""===v.value)),T=async()=>{p.value=!1,a.emit("operateLayer",{content:{id:c.value?.id,name:y.value,visualType:c.value?.visualType,visualId:c.value?.visualId},type:"rename"});for(let e=0;e<n.value[n.value.length-1].children.length;e++)if(n.value[n.value.length-1].children[e].id===c.value?.id){n.value[n.value.length-1].children[e].label=y.value;break}await(0,r.PQ)({id:c.value?.id,name:y.value})},L=async e=>{n.value=[];const a=await(0,r.Yu)(e);null!=a&&0===a.code&&a.data.forEach((e=>{let a=!0;for(let l=0;l<n.value.length;l++)n.value[l].id===e.dataListId&&(n.value[l].children.push({id:e.fileId,label:e.fileName,flag:!1,children:[],visualType:e.visualType,visualId:e.visualId}),a=!1);a&&(n.value.push({id:e.dataListId,label:e.dataListName,flag:!0,children:[]}),n.value[n.value.length-1].children.push({id:e.fileId,label:e.fileName,flag:!1,children:[],visualType:e.visualType,visualId:e.visualId}))}));const l=await(0,r.J4)(e);null!=l&&0===a.code&&l.data.length>0&&(n.value.push({id:"",label:"分析结果集",flag:!0,children:[]}),l.data.forEach((e=>{n.value[n.value.length-1].children.push({id:e.id,label:e.fileName,flag:!1,children:[],visualType:e.visualType,visualId:e.visualId})})))};return(0,t.Jd)((()=>{clearTimeout(l)})),(0,t.YP)((()=>Qe.ZP.currentRoute.value.params.id),(async e=>{o.value=!0,void 0!==l&&clearTimeout(l),await L(e),o.value=!1}),{immediate:!0}),{Search:X.Search,addData:m,skeletonFlag:o,operateLayer:h,defaultProps:i,rightClick:k,showRightMenu:s,menu:u,treeData:n,isLayerVisual:I,addDrawData:f,addAnalyse:g,downloadAble:b,dialogRename:p,input:y,btnClick:T}}});const Aa=(0,ae.Z)(Fa,[["render",Va],["__scopeId","data-v-4efe9c6a"]]);var Na=Aa;const Ha=e=>((0,t.dD)("data-v-99e5c598"),e=e(),(0,t.Cn)(),e),Pa={class:"layer-manage"},Wa=Ha((()=>(0,t._)("div",{class:"bottom-resize"},null,-1))),Sa={class:"layer-manage-body"},Za=Ha((()=>(0,t._)("div",{class:"input"},null,-1))),ja={class:"content"},Ea={class:"scroll"},za={class:"custom"},Ra=["onClick"],Ua=Ha((()=>(0,t._)("div",{class:"bottom"},[(0,t._)("strong",{style:{"margin-left":"30px"}},"图层管理")],-1)));function Ma(e,a,l,i,n,s){const o=(0,t.up)("el-checkbox"),u=(0,t.up)("CircleClose"),d=(0,t.up)("el-icon"),r=(0,t.up)("el-tree"),c=(0,t.up)("el-scrollbar");return(0,t.wg)(),(0,t.iD)("div",Pa,[Wa,(0,t._)("div",Sa,[Za,(0,t._)("div",ja,[(0,t._)("div",Ea,[(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t._)("div",null,[(0,t.Wm)(r,{data:e.treeData,props:e.defaultProps,draggable:"","allow-drop":e.allowDrop,onNodeDrop:e.dragHandle},{default:(0,t.w5)((({data:a})=>[(0,t._)("div",za,[(0,t.Wm)(o,{modelValue:a.flag,"onUpdate:modelValue":e=>a.flag=e,size:"large",onChange:l=>e.changeClick(a)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,V.zw)(a.label),1)])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),(0,t._)("div",{class:"close",onClick:l=>e.closeClick(a.id)},[(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[(0,t.Wm)(u)])),_:1})],8,Ra)])])),_:1},8,["data","props","allow-drop","onNodeDrop"])])])),_:1})])]),Ua])])}var qa=(0,t.aZ)({props:{layerList:{type:Array}},emits:["closeLayer","hideLayer","moveLayer"],setup(e,a){const l={children:"children",label:"label"},i=(0,d.iH)(""),n=(0,d.iH)([]),s=async e=>{for(let l=0;l<n.value.length;l++)if(n.value[l].id===e.id)return;n.value.unshift({id:e.id,label:e.name,visualType:e.visualType,children:[],flag:!0,visualId:e.visualId});const a=[];n.value.forEach((e=>{a.push(e.id)}));await(0,r.tj)(Qe.ZP.currentRoute.value.params.id,a)},o=async e=>{for(let l=0;l<n.value.length;l++)if(n.value[l].id===e){n.value.splice(l,1);const t=[];n.value.forEach((e=>{t.push(e.id)}));const i=await(0,r.tj)(Qe.ZP.currentRoute.value.params.id,t);return null!=i&&0===i.code&&(0,G.Iv)("success","成功","已移除图层"),void a.emit("closeLayer",e)}},u=async e=>{for(let a=0;a<n.value.length;a++)if(n.value[a].id===e){n.value.splice(a,1);const e=[];return n.value.forEach((a=>{e.push(a.id)})),void await(0,r.tj)(Qe.ZP.currentRoute.value.params.id,e)}},c=e=>{a.emit("hideLayer",{flag:e.flag,id:e.id})},v=(e,a,l)=>e.level===a.level&&(e.parent.id===a.parent.id?"prev"===l||"next"===l:void 0),p=async(e,l,t,i)=>{let s="";if(console.log(t),"before"===t){for(let a=0;a<n.value.length;a++)if(n.value[a].id===e.data.id){0!=a&&(s=n.value[a+1].id);break}}else s=l.data.id;a.emit("moveLayer",{drop:e.data.id,target:s});const o=[];n.value.forEach((e=>{o.push(e.id)})),await(0,r.tj)(Qe.ZP.currentRoute.value.params.id,o)},y=()=>n.value.length;return(0,t.bv)((()=>{e.layerList?.forEach((e=>{n.value.push({id:e.id,label:e.fileName,visualType:e.visualType,flag:!0,children:[],visualId:e.visualId})}))})),{Search:X.Search,serach:i,treeData:n,defaultProps:l,addLayer:s,Delete:X.Delete,closeClick:o,changeClick:c,delLayer:u,dragHandle:p,allowDrop:v,getLayers:y}}});const Ja=(0,ae.Z)(qa,[["render",Ma],["__scopeId","data-v-99e5c598"]]);var Oa=Ja;const Ka={class:"right-visual"},Ya={ref:"container",class:"container"},$a={class:"name"},Ba={class:"btn"};function Xa(e,a,l,i,n,s){const o=(0,t.up)("chart-visual"),u=(0,t.up)("el-dialog"),d=(0,t.up)("el-input"),r=(0,t.up)("el-button");return(0,t.wg)(),(0,t.iD)("div",Ka,[(0,t._)("div",Ya,null,512),(0,t.Wm)(u,{modelValue:e.chartVisual,"onUpdate:modelValue":a[0]||(a[0]=a=>e.chartVisual=a),width:"900px",id:"chart",title:"可视化结果"},{default:(0,t.w5)((()=>[(0,t.Wm)(o,{chartVisualInfo:e.chartVisualInfo},null,8,["chartVisualInfo"])])),_:1},8,["modelValue"]),(0,t.Wm)(u,{modelValue:e.dialogVisible,"onUpdate:modelValue":a[2]||(a[2]=a=>e.dialogVisible=a),width:300,title:"geoJsonLine"==e.visualType?"断面名称：":"区域名称："},{default:(0,t.w5)((()=>[(0,t._)("div",$a,[(0,t.Wm)(d,{modelValue:e.inputValue,"onUpdate:modelValue":a[1]||(a[1]=a=>e.inputValue=a)},null,8,["modelValue"]),(0,t._)("div",Ba,[(0,t.Wm)(r,{type:"primary",plain:"",size:"small",onClick:e.clickHandle},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1},8,["onClick"])])])])),_:1},8,["modelValue","title"])])}var Ga=l(7709),Qa=l.n(Ga),el=l(5884),al=l.n(el);const ll={class:"chart-visual"};function tl(e,a,l,i,n,s){const o=(0,t.up)("section-visual"),u=(0,t.up)("section-contrast"),d=(0,t.up)("section-flush"),r=(0,t.up)("flow-sand-z"),c=(0,t.up)("rate-and-direction"),v=(0,t.up)("salinity"),p=(0,t.up)("sand-content"),y=(0,t.up)("suspension");return(0,t.wg)(),(0,t.iD)("div",ll,["section"===e.chartInfo.visualType?((0,t.wg)(),(0,t.j4)(o,{key:0,chartInfo:e.chartInfo},null,8,["chartInfo"])):(0,t.kq)("",!0),"sectionContrast"===e.chartInfo.visualType?((0,t.wg)(),(0,t.j4)(u,{key:1,chartInfo:e.chartInfo},null,8,["chartInfo"])):(0,t.kq)("",!0),"sectionFlush"===e.chartInfo.visualType?((0,t.wg)(),(0,t.j4)(d,{key:2,chartInfo:e.chartInfo},null,8,["chartInfo"])):(0,t.kq)("",!0),"flowSand_Z"===e.chartInfo.visualType?((0,t.wg)(),(0,t.j4)(r,{key:3,visualId:e.chartInfo.visualId},null,8,["visualId"])):(0,t.kq)("",!0),"rateDirection"===e.chartInfo.visualType?((0,t.wg)(),(0,t.j4)(c,{key:4,visualId:e.chartInfo.visualId},null,8,["visualId"])):(0,t.kq)("",!0),"salinity"===e.chartInfo.visualType?((0,t.wg)(),(0,t.j4)(v,{key:5,visualId:e.chartInfo.visualId},null,8,["visualId"])):(0,t.kq)("",!0),"sandContent"===e.chartInfo.visualType?((0,t.wg)(),(0,t.j4)(p,{key:6,visualId:e.chartInfo.visualId},null,8,["visualId"])):(0,t.kq)("",!0),"suspension"===e.chartInfo.visualType?((0,t.wg)(),(0,t.j4)(y,{key:7,visualId:e.chartInfo.visualId},null,8,["visualId"])):(0,t.kq)("",!0)])}const il={class:"section",ref:"section"};function nl(e,a,l,i,n,s){return(0,t.wg)(),(0,t.iD)("div",il,null,512)}var sl=l(9043),ol=(0,t.aZ)({props:{chartInfo:{type:Object}},setup(e){const a=(0,d.iH)();let l,i={};const n=async()=>{const a=await(0,r.If)(e.chartInfo?.id);if(null!=a&&0===a.code){const e=[];a.data.list.forEach(((a,l)=>{e.push(40*l)})),i={title:{text:"地形剖面图",left:"5%"},tooltip:{trigger:"axis"},toolbox:{right:"50px",feature:{dataZoom:{yAxisIndex:"none",brushStyle:{color:"#869d9d",opacity:.4}},restore:{},saveAsImage:{pixelRatio:2}}},grid:{show:!0,borderColor:"#867e76"},xAxis:{type:"category",axisLine:{onZero:!1},data:e},yAxis:{type:"value",name:"高程(m)",splitLine:{show:!1},interval:5},series:[{data:a.data.list,type:"line",connectNulls:!0,symbol:"none",animation:!1,smooth:!0,emphasis:{disabled:!0},markLine:{symbol:["none","none"],animation:!1,lineStyle:{color:"#21373d",width:1,type:"dotted"},label:{show:!1},data:[{yAxis:0,label:{formatter:"海平面",show:!0,position:"insideEndTop"},lineStyle:{type:"solid",width:.7}},{yAxis:-5},{yAxis:-10},{yAxis:-15},{yAxis:-20},{yAxis:-25},{yAxis:-30},{yAxis:-35}],silent:!0},markArea:{silent:!0,data:[[{yAxis:0,itemStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#b0d5df"},{offset:1,color:"#11659a"}]}}},{yAxis:-30}]]},lineStyle:{color:"#867e76",width:1},areaStyle:{origin:"start",opacity:1,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#e4dfd7"},{offset:1,color:"#bbb5ac"}]}}}]}}};return(0,t.bv)((async()=>{await n(),l=sl.S1(a.value),l.setOption(i)})),{section:a}}});const ul=(0,ae.Z)(ol,[["render",nl],["__scopeId","data-v-2dc48bf9"]]);var dl=ul;const rl={class:"sectionContrast",ref:"sectionContrast"};function cl(e,a,l,i,n,s){return(0,t.wg)(),(0,t.iD)("div",rl,null,512)}var vl=(0,t.aZ)({props:{chartInfo:{type:Object}},setup(e){const a=(0,d.iH)();let l,i={};const n=async()=>{const a=await(0,r.cE)(e.chartInfo?.id);if(null!=a&&0===a.code){const e=[],l=["#f44336","#185abd","#c5f6c5"],t=[];a.data[0].forEach(((e,a)=>{t.push(40*a)})),a.data.forEach(((t,i)=>{i!=a.data.length-1?e.push({name:i,data:t,type:"line",connectNulls:!0,symbol:"none",animation:!1,smooth:!0,lineStyle:{color:l[i]}}):e.push({name:i,data:t,type:"line",connectNulls:!0,symbol:"none",animation:!1,smooth:!0,lineStyle:{color:l[i]},markLine:{symbol:["none","none"],animation:!1,lineStyle:{color:"#21373d",width:1,type:"dotted"},label:{show:!1},data:[{yAxis:0,lineStyle:{type:"solid",width:.7}},{yAxis:-5},{yAxis:-10},{yAxis:-15},{yAxis:-20},{yAxis:-25},{yAxis:-30},{yAxis:-35}],silent:!0}})})),i={title:{text:"地形剖面对比图",left:"5%"},tooltip:{trigger:"axis"},toolbox:{right:"50px",feature:{dataZoom:{yAxisIndex:"none",brushStyle:{color:"#869d9d",opacity:.4}},restore:{},saveAsImage:{pixelRatio:2}}},grid:{show:!0,borderColor:"#867e76"},xAxis:{data:t,type:"category",axisLine:{onZero:!1}},yAxis:{type:"value",name:"高程(m)",splitLine:{show:!1},interval:5},series:e}}};return(0,t.bv)((async()=>{await n(),l=sl.S1(a.value),l.setOption(i)})),{sectionContrast:a}}});const pl=(0,ae.Z)(vl,[["render",cl],["__scopeId","data-v-58bef736"]]);var yl=pl;const ml={class:"section-flush",ref:"sectionFlush"};function fl(e,a,l,i,n,s){return(0,t.wg)(),(0,t.iD)("div",ml,null,512)}var gl=(0,t.aZ)({props:{chartInfo:{type:Object}},setup(e){const a=(0,d.iH)();let l,i={};const n=async()=>{const a=await(0,r.EY)(e.chartInfo?.id);if(null!=a&&0===a.code){const e=a.data.benchmark,l=a.data.refer,t=a.data.flush,n=[];t.forEach(((e,a)=>{n.push(40*a)})),i={title:{text:"地形剖面对比图",left:"5%"},tooltip:{trigger:"axis"},toolbox:{right:"50px",feature:{right:"50px",dataZoom:{yAxisIndex:"none",brushStyle:{color:"#869d9d",opacity:.4}},restore:{},saveAsImage:{pixelRatio:2}}},grid:[{show:!0,borderColor:"#867e76",bottom:"55%"},{top:"55%",show:!0,borderColor:"#867e76"}],xAxis:[{data:n,type:"category",axisLine:{onZero:!1}},{data:n,type:"category",gridIndex:1}],yAxis:[{type:"value",name:"高程(m)",splitLine:{show:!1},interval:5},{type:"value",name:"高程(m)",splitLine:{show:!1},interval:2,gridIndex:1}],visualMap:{top:"2%",left:"60%",orient:"horizontal",pieces:[{gt:0,lte:99,color:"#3f51b5",label:"冲"},{gt:-99,lte:0,color:"#f44336",label:"淤"}]},series:[{name:"1",data:e,type:"line",connectNulls:!0,symbol:"none",animation:!1,smooth:!0,lineStyle:{color:"#f44336"},areaStyle:{color:"#f44336",opacity:.3}},{name:"2",data:l,type:"line",connectNulls:!0,symbol:"none",animation:!1,smooth:!0,lineStyle:{color:"#3f51b5"},areaStyle:{color:"#3f51b5",opacity:.3},markLine:{symbol:["none","none"],animation:!1,lineStyle:{color:"#21373d",width:1,type:"dotted"},label:{show:!1},data:[{yAxis:0,lineStyle:{type:"solid",width:.7}},{yAxis:-5},{yAxis:-10},{yAxis:-15},{yAxis:-20},{yAxis:-25},{yAxis:-30}],silent:!0}},{xAxisIndex:1,yAxisIndex:1,data:t,type:"line",connectNulls:!0,symbol:"none",animation:!1,smooth:!0,silent:!0,markLine:{symbol:["none","none"],animation:!1,lineStyle:{color:"#21373d",width:1,type:"dotted"},label:{show:!1},data:[{yAxis:10},{yAxis:8},{yAxis:6},{yAxis:4},{yAxis:2},{yAxis:0,lineStyle:{type:"solid"}},{yAxis:-10},{yAxis:-8},{yAxis:-6},{yAxis:-4},{yAxis:-2}]},areaStyle:{origin:0}}]}}};return(0,t.bv)((async()=>{await n(),l=sl.S1(a.value),l.setOption(i)})),{sectionFlush:a}}});const hl=(0,ae.Z)(gl,[["render",fl],["__scopeId","data-v-0b652ea8"]]);var wl=hl,kl=l(304),Il=l(1163),bl=l(5392),Tl=l(8652),Ll=l(6692),Dl=(0,t.aZ)({components:{SectionVisual:dl,SectionContrast:yl,SectionFlush:wl,FlowSandZ:kl.Z,RateAndDirection:Il.Z,Salinity:bl.Z,SandContent:Tl.Z,Suspension:Ll.Z},props:{chartVisualInfo:{type:Object}},setup(e){const a=(0,t.Fl)((()=>e.chartVisualInfo));return(0,t.bv)((()=>{console.log(a.value)})),{chartInfo:a}}});const _l=(0,ae.Z)(Dl,[["render",tl]]);var Cl=_l,xl=(0,t.aZ)({components:{ChartVisual:Cl},props:{layerList:{type:Array}},emits:["drawHandle"],setup(e,a){const l=(0,d.iH)();let i;const n=(0,d.iH)(!1),s=(0,d.iH)(),o=(0,d.iH)(!1),u=(0,d.iH)(""),c=(0,d.iH)(""),v=(0,d.iH)([]);let p;const y=new(al())({controls:{combine_features:!1,uncombine_features:!1,trash:!1,point:!1,polygon:!1}}),m=new(al())({controls:{combine_features:!1,uncombine_features:!1,trash:!1,point:!1,line_string:!1}}),f=e=>{0===e?(i.hasControl(y)&&i.removeControl(y),i.hasControl(m)&&i.removeControl(m)):1===e?(i.hasControl(m)&&i.removeControl(m),i.hasControl(y)||i.addControl(y,"top-left")):2===e&&(i.hasControl(y)&&i.removeControl(y),i.hasControl(m)||i.addControl(m,"top-left"))},g=e=>{i.hasControl(y)&&(c.value="geoJsonLine",p=e.features[0],o.value=!0,y.deleteAll()),i.hasControl(m)&&(c.value="geoJsonPolygon",p=e.features[0],o.value=!0,m.deleteAll())},h=()=>{a.emit("drawHandle",{geoJson:p,visualType:c.value,fileName:u.value}),o.value=!1},w=(e,a,l,t)=>e>l[0][0]&&e<l[2][0]&&a>l[2][1]&&a<l[0][1]&&"none"!=i.getLayoutProperty(t,"visibility"),k=()=>{i=new(Qa().Map)({container:l.value,accessToken:"pk.eyJ1Ijoiam9obm55dCIsImEiOiJja2xxNXplNjYwNnhzMm5uYTJtdHVlbTByIn0.f1GfZbFLWjiEayI6hb_Qvg",style:"mapbox://styles/johnnyt/cl9miecpn001t14rspop38nyk",center:[121.18,31.723],zoom:8}),i.on("load",(async()=>{await I()})),i.doubleClickZoom.disable(),i.on("dblclick",(e=>{for(let a=0;a<v.value.length;a++)w(e.lngLat.lng,e.lngLat.lat,v.value[a].coordinates,v.value[a].id)&&(new(Qa().Popup)).setLngLat([(v.value[a].coordinates[0][0]+v.value[a].coordinates[2][0])/2,(v.value[a].coordinates[0][1]+v.value[a].coordinates[2][1])/2]).setHTML(v.value[a].description).addTo(i)}))},I=async()=>{for(let a=e.layerList.length-1;a>=0;a--)await b(e.layerList[a]);i.on("draw.create",g)},b=async e=>{if(void 0===i.getLayer(e.id)){let a="line";if("lineVectorTile3D"===e.visualType||"lineVectorTile"===e.visualType||"flushContour"===e.visualType?a="line":"pointVectorTile"===e.visualType||"pointVectorTile3D"===e.visualType?a="circle":"polygonVectorTile"!==e.visualType&&"polygonVectorTile3D"!==e.visualType||(a="fill"),"lineVectorTile3D"===e.visualType||"lineVectorTile"===e.visualType||"pointVectorTile"===e.visualType||"pointVectorTile3D"===e.visualType||"polygonVectorTile"===e.visualType||"polygonVectorTile3D"===e.visualType||"flushContour"===e.visualType)i.addSource(e.id,{type:"vector",tiles:[`https://192.168.30.3:8050/monitor/visual/getVectorTiles/${e.visualId}/{x}/{y}/{z}`]}),i.addLayer({id:e.id,source:e.id,type:a,"source-layer":e.visualId});else if("rasterTile"===e.visualType||"elevationFlush"===e.visualType||"slope"===e.visualType)i.addSource(e.id,{type:"raster",tiles:[`https://192.168.30.3:8050/monitor/visual/getRaster/${e.visualId}/{x}/{y}/{z}`]}),i.addLayer({id:e.id,type:"raster",source:e.id});else if("png"===e.visualType||"movePng"===e.visualType||"regionFlush"===e.visualType){const a=await(0,r.Pk)(e.visualId);null!=a&&0===a.code&&(i.addSource(e.id,{type:"image",url:`https://192.168.30.3:8050/monitor/visual/getPngResource/${e.visualId}`,coordinates:a.data}),i.addLayer({id:e.id,type:"raster",source:e.id}))}else if("volume"===e.visualType){const a=await(0,r.L5)(e.visualId);if(null!=a&&0===a.code){i.addSource(e.id,{type:"image",url:`https://192.168.30.3:8050/monitor/visual/getPngResource/${e.visualId}`,coordinates:a.data.coordinates}),i.addLayer({id:e.id,type:"raster",source:e.id});const l=`深度：${a.data.deep}，容积：${a.data.volume}m³`;v.value.push({id:e.id,coordinates:a.data.coordinates,description:l})}}else if("geoJsonLine"===e.visualType||"geoJsonPoint"===e.visualType||"geoJsonPolygon"===e.visualType){let a="line";"geoJsonPoint"===e.visualType?a="circle":"geoJsonPolygon"===e.visualType&&(a="fill");const l=await(0,r.Dg)(e.id);null!=l&&0===l.code&&(i.addSource(e.id,{type:"geojson",data:l.data}),"fill"===a?i.addLayer({id:e.id,type:a,source:e.id,paint:{"fill-opacity":.5,"fill-color":"#f24545"}}):i.addLayer({id:e.id,type:a,source:e.id}))}}},T=async e=>{s.value=e,n.value=!0},L=e=>{if(void 0!=i.getLayer(e)){i.removeLayer(e),i.removeSource(e);for(let a=0;a<v.value.length;a++)if(e===v.value[a].id)return void v.value.splice(a,1)}},D=e=>{""===e.target?i.moveLayer(e.drop):i.moveLayer(e.drop,e.target)},_=e=>{void 0!=i.getLayer(e.id)&&(e.flag?i.setLayoutProperty(e.id,"visibility","visible"):i.setLayoutProperty(e.id,"visibility","none"))},C=()=>{i.resize()};return(0,t.bv)((()=>{k()})),{container:l,mapResize:C,addMapLayer:b,removeLayer:L,changeLayerState:_,operateDraw:f,addChart:T,chartVisual:n,chartVisualInfo:s,moveLayer:D,dialogVisible:o,inputValue:u,visualType:c,clickHandle:h}}});const Vl=(0,ae.Z)(xl,[["render",Xa],["__scopeId","data-v-8258a164"]]);var Fl=Vl,Al=(0,t.aZ)({components:{TopTool:na,RightVisual:Fl,DataManage:Na,LayerManage:Oa},setup(){const e=(0,d.iH)(!0),a=(0,d.iH)([]),l=(0,d.iH)(),i=(0,d.iH)(),n=(0,d.iH)(),s=(0,d.iH)(),o=(0,d.iH)();const u=e=>{s.value.addData(e)},c=e=>{"add"===e.type?(o.value.addLayer(e.content),n.value.addMapLayer(e.content)):"del"===e.type?(console.log(e,e.content),o.value.delLayer(e.content.id),n.value.removeLayer(e.content.id)):"chart"===e.type&&n.value.addChart(e.content)},v=e=>{n.value.removeLayer(e)},p=e=>{n.value.changeLayerState(e)},y=e=>{n.value.moveLayer(e)},m=e=>{n.value.operateDraw(e)},f=async e=>{const a=await s.value.addDrawData(e);o.value.addLayer(a),n.value.addMapLayer(a)},g=async e=>{await s.value.addAnalyse(e)};return(0,t.YP)((()=>Qe.ZP.currentRoute.value.params.id),(async(l,t)=>{if(void 0!==l){e.value=!0;const t=await(0,r.tI)(l);null!=t&&0===t.code&&(a.value=t.data),e.value=!1}}),{immediate:!0}),{leftResize:l,left:i,rightMap:n,returnFileList:u,dataManage:s,operateLayer:c,layerManage:o,closeLayer:v,hideLayer:p,operateDraw:m,drawHandle:f,analyse:g,skeletonFlag:e,layerList:a,moveLayer:y}}});const Nl=(0,ae.Z)(Al,[["render",u],["__scopeId","data-v-1303b93e"]]);var Hl=Nl}}]);
//# sourceMappingURL=883.79b7b7d8.js.map